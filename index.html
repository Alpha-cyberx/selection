<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberXcode | Global Cybersecurity Alliance</title>
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- EmailJS -->
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script>
        (function() {
            emailjs.init("user_your_user_id_here"); // আপনার EmailJS User ID দিন
        })();
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0f1a 0%, #04070c 100%);
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
        }

        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header Styles */
        .header {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 30px;
            background: linear-gradient(135deg, rgba(12, 18, 32, 0.95), rgba(4, 7, 12, 0.95));
            border-radius: 20px;
            border: 2px solid #00ffd5;
            box-shadow: 0 10px 40px rgba(0, 255, 213, 0.2);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #00ffd5, #00b8a3, #00ffd5);
        }

        .header h1 {
            color: #00ffd5;
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 0 0 20px rgba(0, 255, 213, 0.5);
            background: linear-gradient(135deg, #00ffd5, #00b8a3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .tagline {
            color: #a0e0ff;
            font-size: 1.2rem;
            margin-bottom: 25px;
            opacity: 0.9;
        }

        .brand {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
        }

        .brand-item {
            background: rgba(0, 255, 213, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid rgba(0, 255, 213, 0.3);
            font-weight: 600;
            color: #00ffd5;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .social-link {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #00ffd5;
            text-decoration: none;
            font-weight: 500;
            padding: 10px 20px;
            border-radius: 50px;
            background: rgba(0, 255, 213, 0.05);
            border: 1px solid rgba(0, 255, 213, 0.2);
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: rgba(0, 255, 213, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 213, 0.2);
        }

        .social-link i {
            font-size: 1.2rem;
        }

        .website-link {
            background: linear-gradient(135deg, #00ffd5, #00b8a3);
            color: #000;
            font-weight: 700;
        }

        .instagram-link {
            background: linear-gradient(135deg, #833AB4, #FD1D1D, #FCB045);
            color: white;
        }

        /* Card Styles */
        .card {
            background: rgba(12, 18, 32, 0.9);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 255, 213, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .card h2 {
            color: #00ffd5;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8rem;
            position: relative;
            padding-bottom: 15px;
        }

        .card h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, #00ffd5, transparent);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #a0e0ff;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            background: rgba(10, 15, 26, 0.8);
            border: 2px solid #2a3b5a;
            border-radius: 10px;
            color: #ffffff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #00ffd5;
            box-shadow: 0 0 15px rgba(0, 255, 213, 0.3);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            margin: 10px 5px;
            min-width: 200px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00ffd5, #00b8a3);
            color: #000;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            color: white;
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff4d4d, #cc0000);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn i {
            font-size: 1.2rem;
        }

        /* Status Messages */
        .status-box {
            padding: 15px 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }

        .status-success {
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid #00ff88;
            color: #00ff88;
            display: block;
        }

        .status-error {
            background: rgba(255, 77, 77, 0.1);
            border: 2px solid #ff4d4d;
            color: #ff4d4d;
            display: block;
        }

        .status-info {
            background: rgba(0, 255, 213, 0.1);
            border: 2px solid #00ffd5;
            color: #00ffd5;
            display: block;
        }

        /* OTP Section */
        .otp-container {
            max-width: 500px;
            margin: 0 auto;
            text-align: center;
        }

        .otp-input {
            font-size: 32px;
            letter-spacing: 20px;
            text-align: center;
            font-weight: bold;
            color: #00ffd5;
            background: rgba(0, 255, 213, 0.1);
            border: 2px solid #00ffd5;
        }

        /* Exam Questions */
        .question-box {
            background: rgba(10, 15, 26, 0.6);
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border-left: 5px solid #00ffd5;
        }

        .question-number {
            color: #00ffd5;
            font-weight: bold;
            font-size: 1.3rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .question-number i {
            font-size: 1.2rem;
        }

        .keyword-hint {
            font-size: 0.9rem;
            color: #a0e0ff;
            margin-top: 10px;
            background: rgba(160, 224, 255, 0.1);
            padding: 8px 12px;
            border-radius: 6px;
            display: inline-block;
        }

        /* Results */
        .result-summary {
            background: rgba(0, 255, 213, 0.05);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
            border: 2px solid rgba(0, 255, 213, 0.2);
        }

        .score-display {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, #00ffd5, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 20px 0;
        }

        .qualification-badge {
            display: inline-block;
            padding: 10px 25px;
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            color: white;
            border-radius: 50px;
            font-weight: bold;
            margin: 20px 0;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Certificate */
        .certificate {
            background: white;
            color: black;
            padding: 50px;
            border-radius: 20px;
            margin: 40px auto;
            max-width: 900px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.4);
            border: 15px solid #00ffd5;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .certificate::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M0,0 L100,0 L100,100 L0,100 Z" fill="none" stroke="%2300ffd5" stroke-width="1" stroke-dasharray="5,5"/></svg>');
            opacity: 0.1;
        }

        .certificate-header {
            color: #004a3d;
            margin-bottom: 30px;
            font-size: 2.5rem;
            position: relative;
        }

        .certificate-header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 3px;
            background: linear-gradient(90deg, #00ffd5, #00b8a3, #00ffd5);
        }

        .certificate h3 {
            color: #007a63;
            margin: 30px 0;
            font-size: 2.2rem;
            padding: 20px;
            border: 3px dashed #00ffd5;
            border-radius: 10px;
        }

        .certificate-details {
            margin: 30px 0;
            padding: 25px;
            background: #f5f5f5;
            border-radius: 15px;
            border: 2px solid #ddd;
        }

        .certificate-details p {
            margin: 15px 0;
            font-size: 1.1rem;
        }

        .issuer-info {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #ccc;
        }

        .watermark {
            position: absolute;
            font-size: 120px;
            color: rgba(0, 255, 213, 0.1);
            transform: rotate(-45deg);
            top: 30%;
            left: 10%;
            font-weight: bold;
            pointer-events: none;
        }

        /* WhatsApp Info */
        .whatsapp-info {
            background: rgba(37, 211, 102, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            border: 3px solid #25D366;
            text-align: center;
        }

        .whatsapp-info h3 {
            color: #25D366;
            margin-bottom: 15px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px 20px;
            margin-top: 50px;
            background: rgba(12, 18, 32, 0.8);
            border-radius: 15px;
            border-top: 2px solid rgba(0, 255, 213, 0.2);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .copyright {
            color: #a0e0ff;
            opacity: 0.7;
            font-size: 0.9rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .brand {
                flex-direction: column;
                gap: 10px;
            }
            
            .social-links {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
            }
            
            .certificate {
                padding: 30px 20px;
            }
            
            .certificate-header {
                font-size: 1.8rem;
            }
            
            .certificate h3 {
                font-size: 1.6rem;
            }
            
            .otp-input {
                font-size: 24px;
                letter-spacing: 10px;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 255, 213, 0.3);
            border-top: 3px solid #00ffd5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }
            
            .certificate,
            .certificate * {
                visibility: visible;
            }
            
            .certificate {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0;
                padding: 20px;
                box-shadow: none;
                border: none;
            }
            
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>

<!-- Particles Background -->
<div id="particles-js"></div>

<div class="container">
    <!-- Header Section -->
    <header class="header">
        <h1><i class="fas fa-shield-alt"></i> CyberXcode Alliance</h1>
        <p class="tagline">Global Cybersecurity Recruitment & Training Portal</p>
        
        <div class="brand">
            <span class="brand-item">CyberXcode</span>
            <span class="brand-item">BLACK CODE UNION</span>
            <span class="brand-item">Chip Exploit</span>
        </div>
        
        <div class="social-links">
            <a href="https://cyberxcode2.wordpress.com" target="_blank" class="social-link website-link">
                <i class="fas fa-globe"></i> cyberxcode2.wordpress.com
            </a>
            <a href="https://instagram.com/alpha.x.admin" target="_blank" class="social-link instagram-link">
                <i class="fab fa-instagram"></i> @alpha.x.admin
            </a>
        </div>
    </header>

    <!-- Registration Section -->
    <section class="card" id="registrationBox">
        <h2><i class="fas fa-user-plus"></i> Applicant Registration</h2>
        
        <div class="form-group">
            <label for="name"><i class="fas fa-user"></i> Full Name *</label>
            <input type="text" id="name" placeholder="Enter your full name" required>
        </div>
        
        <div class="form-group">
            <label for="email"><i class="fas fa-envelope"></i> Email Address *</label>
            <input type="email" id="email" placeholder="Enter your email address" required>
        </div>
        
        <div class="form-group">
            <label for="phone"><i class="fas fa-phone"></i> WhatsApp Number (Optional)</label>
            <input type="tel" id="phone" placeholder="Enter WhatsApp number with country code">
        </div>
        
        <div class="form-group">
            <label for="group"><i class="fas fa-users"></i> Select Specialization Group *</label>
            <select id="group" required>
                <option value="">Choose your group...</option>
                <option value="Beginner Cyber Awareness">Beginner Cyber Awareness</option>
                <option value="Blue Team – SOC Monitoring">Blue Team – SOC Monitoring</option>
                <option value="Red Team – Defense Simulation">Red Team – Defense Simulation</option>
                <option value="Purple Team – Strategy">Purple Team – Strategy</option>
                <option value="DFIR – Digital Forensics">DFIR – Digital Forensics</option>
                <option value="Threat Intelligence">Threat Intelligence</option>
                <option value="Cloud Security">Cloud Security</option>
                <option value="AI & Automation Security">AI & Automation Security</option>
                <option value="Cyber Research Lab">Cyber Research Lab</option>
                <option value="Elite Operations Unit">Elite Operations Unit</option>
                <option value="Master Security Architects">Master Security Architects</option>
                <option value="Command Council (Leadership)">Command Council (Leadership)</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="level"><i class="fas fa-graduation-cap"></i> Exam Level *</label>
            <select id="level" required>
                <option value="">Select exam level...</option>
                <option value="elite">Elite Level</option>
                <option value="master">Master Level</option>
            </select>
        </div>
        
        <div id="regStatus" class="status-box"></div>
        
        <div class="text-center">
            <button class="btn btn-primary" onclick="sendOTP()" id="sendOtpBtn">
                <i class="fas fa-paper-plane"></i> Send Email Verification OTP
            </button>
        </div>
    </section>

    <!-- OTP Verification Section -->
    <section class="card hidden" id="otpBox">
        <h2><i class="fas fa-mail-bulk"></i> Email Verification</h2>
        
        <div class="otp-container">
            <p>Enter the 6-digit OTP sent to your email:</p>
            
            <div class="form-group">
                <input type="text" id="otpInput" class="otp-input" maxlength="6" placeholder="000000"
                       oninput="this.value = this.value.replace(/[^0-9]/g, '')">
            </div>
            
            <div id="otpStatus" class="status-box"></div>
            
            <div class="text-center">
                <button class="btn btn-success" onclick="verifyOTP()" id="verifyOtpBtn">
                    <i class="fas fa-check-circle"></i> Verify OTP
                </button>
                <button class="btn btn-secondary" onclick="resendOTP()" id="resendOtpBtn">
                    <i class="fas fa-redo"></i> Resend OTP
                </button>
                <button class="btn btn-danger" onclick="cancelVerification()">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </section>

    <!-- Exam Section -->
    <section class="card hidden" id="examBox">
        <h2 id="examTitle"></h2>
        <div id="questionsContainer"></div>
        
        <div id="examStatus" class="status-box"></div>
        
        <div class="text-center">
            <button class="btn btn-success" onclick="submitExam()" id="submitExamBtn">
                <i class="fas fa-paper-plane"></i> Submit Exam
            </button>
        </div>
    </section>

    <!-- Results Section -->
    <section class="card hidden" id="resultsBox">
        <h2><i class="fas fa-chart-line"></i> Exam Results</h2>
        <div id="resultsContent"></div>
    </section>

    <!-- Certificate Section -->
    <section id="certificateBox" class="hidden"></section>

    <!-- WhatsApp Submission -->
    <div class="whatsapp-info hidden" id="whatsappInfo">
        <h3><i class="fab fa-whatsapp"></i> WhatsApp Submission</h3>
        <p>Your exam results are ready for submission. Click below to send automatically to CyberXcode Admin:</p>
        
        <div class="text-center">
            <button class="btn btn-whatsapp" onclick="sendWhatsAppMessage()" id="whatsappBtn">
                <i class="fab fa-whatsapp"></i> Send Results via WhatsApp
            </button>
        </div>
        
        <p class="mt-20"><small><i class="fas fa-info-circle"></i> Make sure WhatsApp is installed on your device</small></p>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-links">
            <a href="https://cyberxcode2.wordpress.com" target="_blank" class="social-link">
                <i class="fas fa-globe"></i> Official Website
            </a>
            <a href="https://instagram.com/alpha.x.admin" target="_blank" class="social-link">
                <i class="fab fa-instagram"></i> Instagram
            </a>
            <a href="mailto:contact@cyberxcode2.wordpress.com" class="social-link">
                <i class="fas fa-envelope"></i> Email Support
            </a>
        </div>
        
        <div class="copyright">
            <p>&copy; 2024 CyberXcode Global Alliance. All rights reserved.</p>
            <p>Powered by CyberXcode,BLACK CODE UNION & Chip Exploit </p>
        </div>
    </footer>
</div>

<!-- Particles.js -->
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

<script>
// ==================== GLOBAL VARIABLES ====================
let OTP = null;
let userData = {
    name: "",
    email: "",
    phone: "",
    group: "",
    level: "",
    score: 0,
    percent: 0,
    certificateId: "",
    answers: []
};
let otpTimestamp = null;
const OTP_VALID_TIME = 10 * 60 * 1000; // 10 minutes

// ==================== PARTICLES BACKGROUND ====================
particlesJS("particles-js", {
    particles: {
        number: { value: 100, density: { enable: true, value_area: 800 } },
        color: { value: "#00ffd5" },
        shape: { type: "circle" },
        opacity: { value: 0.5, random: true },
        size: { value: 3, random: true },
        line_linked: {
            enable: true,
            distance: 150,
            color: "#00ffd5",
            opacity: 0.4,
            width: 1
        },
        move: { 
            enable: true, 
            speed: 2, 
            direction: "none", 
            random: true,
            out_mode: "out"
        }
    },
    interactivity: {
        detect_on: "canvas",
        events: {
            onhover: { enable: true, mode: "repulse" },
            onclick: { enable: true, mode: "push" }
        }
    },
    retina_detect: true
});

// ==================== QUESTION DATABASE ====================
const questionDatabase = {
    elite: [
        {
            id: 1,
            question: "Explain the Zero Trust security model and its core principles.",
            keywords: ["never trust", "always verify", "least privilege", "micro-segmentation", "identity-based"],
            maxPoints: 10
        },
        {
            id: 2,
            question: "What is the primary purpose of a SIEM system in cybersecurity?",
            keywords: ["log management", "real-time monitoring", "threat detection", "incident response", "security analytics"],
            maxPoints: 10
        },
        {
            id: 3,
            question: "How does MITRE ATT&CK framework help in defense strategies?",
            keywords: ["tactics", "techniques", "adversary behavior", "defense planning", "threat intelligence"],
            maxPoints: 10
        },
        {
            id: 4,
            question: "Describe the process of threat modeling in application security.",
            keywords: ["risk assessment", "attack vectors", "security controls", "mitigation strategies", "STRIDE"],
            maxPoints: 10
        },
        {
            id: 5,
            question: "Differentiate between IDS and IPS systems.",
            keywords: ["intrusion detection", "intrusion prevention", "passive monitoring", "active blocking", "network security"],
            maxPoints: 10
        },
        {
            id: 6,
            question: "Explain the principle of least privilege and its importance.",
            keywords: ["minimum access", "need-to-know", "access control", "security principle", "risk reduction"],
            maxPoints: 10
        },
        {
            id: 7,
            question: "What is encryption at rest and why is it crucial?",
            keywords: ["data protection", "storage encryption", "confidentiality", "data breaches", "cryptographic"],
            maxPoints: 10
        },
        {
            id: 8,
            question: "Outline the key phases of incident response.",
            keywords: ["preparation", "identification", "containment", "eradication", "recovery", "lessons learned"],
            maxPoints: 10
        },
        {
            id: 9,
            question: "Why are audit logs important in cybersecurity?",
            keywords: ["forensics", "compliance", "accountability", "investigation", "security monitoring"],
            maxPoints: 10
        },
        {
            id: 10,
            question: "Describe Secure Software Development Lifecycle (SDLC).",
            keywords: ["security integration", "development phases", "code review", "testing", "deployment security"],
            maxPoints: 10
        }
    ],
    
    master: [
        {
            id: 1,
            question: "Explain the defense-in-depth strategy with practical examples.",
            keywords: ["layered defense", "multiple controls", "security layers", "redundancy", "comprehensive protection"],
            maxPoints: 10
        },
        {
            id: 2,
            question: "Analyze the characteristics of APT (Advanced Persistent Threat) attacks.",
            keywords: ["persistent", "stealthy", "targeted", "long-term", "sophisticated", "evasion"],
            maxPoints: 10
        },
        {
            id: 3,
            question: "Describe SOC maturity levels and their characteristics.",
            keywords: ["process maturity", "automation", "people capability", "technology integration", "continuous improvement"],
            maxPoints: 10
        },
        {
            id: 4,
            question: "What are the primary risks associated with Cloud IAM?",
            keywords: ["privilege escalation", "misconfiguration", "identity exposure", "access management", "cloud security"],
            maxPoints: 10
        },
        {
            id: 5,
            question: "Explain the Cyber Kill Chain framework and its stages.",
            keywords: ["reconnaissance", "weaponization", "delivery", "exploitation", "installation", "command control", "actions objectives"],
            maxPoints: 10
        },
        {
            id: 6,
            question: "Propose a comprehensive ransomware mitigation strategy.",
            keywords: ["backup strategy", "network segmentation", "user training", "patch management", "incident response"],
            maxPoints: 10
        },
        {
            id: 7,
            question: "Outline the digital forensics investigation workflow.",
            keywords: ["collection", "preservation", "analysis", "documentation", "chain of custody", "evidence handling"],
            maxPoints: 10
        },
        {
            id: 8,
            question: "Discuss zero-day vulnerabilities and defense approaches.",
            keywords: ["unknown exploit", "vulnerability management", "patch deployment", "behavior monitoring", "threat intelligence"],
            maxPoints: 10
        },
        {
            id: 9,
            question: "Compare and contrast compliance requirements vs. security needs.",
            keywords: ["regulatory requirements", "risk management", "security controls", "audit compliance", "business objectives"],
            maxPoints: 10
        },
        {
            id: 10,
            question: "Design an API security strategy for modern applications.",
            keywords: ["authentication", "rate limiting", "encryption", "input validation", "monitoring", "access control"],
            maxPoints: 10
        }
    ]
};

// ==================== UTILITY FUNCTIONS ====================
function showStatus(elementId, message, type) {
    const element = document.getElementById(elementId);
    if (!element) return;
    
    element.textContent = message;
    element.className = "status-box";
    
    switch(type) {
        case 'success':
            element.classList.add('status-success');
            break;
        case 'error':
            element.classList.add('status-error');
            break;
        case 'info':
            element.classList.add('status-info');
            break;
    }
    
    // Auto hide success messages after 5 seconds
    if (type === 'success') {
        setTimeout(() => {
            element.className = "status-box";
        }, 5000);
    }
}

function showLoading(buttonId) {
    const button = document.getElementById(buttonId);
    if (button) {
        const originalText = button.innerHTML;
        button.innerHTML = '<span class="loader"></span> Processing...';
        button.disabled = true;
        
        // Store original text for restoration
        button.setAttribute('data-original-text', originalText);
    }
}

function hideLoading(buttonId) {
    const button = document.getElementById(buttonId);
    if (button) {
        const originalText = button.getAttribute('data-original-text');
        if (originalText) {
            button.innerHTML = originalText;
        }
        button.disabled = false;
    }
}

// ==================== OTP FUNCTIONS ====================
async function sendOTP() {
    // Get form data
    userData.name = document.getElementById('name').value.trim();
    userData.email = document.getElementById('email').value.trim();
    userData.phone = document.getElementById('phone').value.trim();
    userData.group = document.getElementById('group').value;
    userData.level = document.getElementById('level').value;
    
    // Validation
    if (!userData.name || !userData.email || !userData.group || !userData.level) {
        showStatus('regStatus', 'Please fill all required fields', 'error');
        return;
    }
    
    if (!userData.email.includes('@') || !userData.email.includes('.')) {
        showStatus('regStatus', 'Please enter a valid email address', 'error');
        return;
    }
    
    // Generate OTP
    OTP = Math.floor(100000 + Math.random() * 900000);
    otpTimestamp = Date.now();
    
    showLoading('sendOtpBtn');
    
    try {
        // Send OTP via EmailJS
        const templateParams = {
            to_email: userData.email,
            user_name: userData.name,
            otp_code: OTP,
            site_name: "CyberXcode",
            current_year: new Date().getFullYear()
        };
        
        // Use your EmailJS configuration
        const response = await emailjs.send(
            'YOUR_SERVICE_ID',      // Replace with your EmailJS Service ID
            'YOUR_TEMPLATE_ID',     // Replace with your EmailJS Template ID
            templateParams
        );
        
        if (response.status === 200) {
            showStatus('regStatus', `OTP sent successfully to ${userData.email}`, 'success');
            
            // Show OTP box
            document.getElementById('otpBox').classList.remove('hidden');
            document.getElementById('registrationBox').style.opacity = '0.7';
            
            // For demo/testing purposes
            console.log('Demo OTP:', OTP);
            setTimeout(() => {
                alert(`OTP for testing: ${OTP}\n(This alert is for demo purposes only)`);
            }, 1000);
        }
    } catch (error) {
        console.error('EmailJS Error:', error);
        
        // Fallback for demo
        showStatus('regStatus', 'Using demo mode - OTP shown below', 'info');
        
        // Show OTP in status box for demo
        showStatus('otpStatus', `DEMO OTP: ${OTP}`, 'info');
        
        // Still show OTP box
        document.getElementById('otpBox').classList.remove('hidden');
        document.getElementById('registrationBox').style.opacity = '0.7';
        
        // Alert for demo
        setTimeout(() => {
            alert(`DEMO MODE: OTP would be sent to ${userData.email}\nFor testing, use OTP: ${OTP}`);
        }, 500);
    } finally {
        hideLoading('sendOtpBtn');
    }
}

function resendOTP() {
    if (!userData.email) {
        showStatus('otpStatus', 'Email not found. Please restart registration.', 'error');
        return;
    }
    
    showLoading('resendOtpBtn');
    
    // Generate new OTP
    OTP = Math.floor(100000 + Math.random() * 900000);
    otpTimestamp = Date.now();
    
    // In production, you would resend via EmailJS
    // For demo, simulate sending
    setTimeout(() => {
        showStatus('otpStatus', `New OTP generated: ${OTP}`, 'info');
        hideLoading('resendOtpBtn');
        
        // Alert for demo
        alert(`New OTP: ${OTP}\n(In production, this would be sent to ${userData.email})`);
    }, 1500);
}

function verifyOTP() {
    const enteredOTP = document.getElementById('otpInput').value.trim();
    
    if (!enteredOTP || enteredOTP.length !== 6) {
        showStatus('otpStatus', 'Please enter a valid 6-digit OTP', 'error');
        return;
    }
    
    // Check OTP expiry
    if (Date.now() - otpTimestamp > OTP_VALID_TIME) {
        showStatus('otpStatus', 'OTP has expired. Please request a new one.', 'error');
        return;
    }
    
    showLoading('verifyOtpBtn');
    
    // Simulate verification delay
    setTimeout(() => {
        if (parseInt(enteredOTP) === OTP) {
            showStatus('otpStatus', 'Email verified successfully!', 'success');
            
            // Proceed to exam after delay
            setTimeout(() => {
                document.getElementById('otpBox').classList.add('hidden');
                document.getElementById('registrationBox').classList.add('hidden');
                startExam();
            }, 1000);
        } else {
            showStatus('otpStatus', 'Invalid OTP. Please try again.', 'error');
        }
        
        hideLoading('verifyOtpBtn');
    }, 1000);
}

function cancelVerification() {
    document.getElementById('otpBox').classList.add('hidden');
    document.getElementById('registrationBox').style.opacity = '1';
    document.getElementById('otpInput').value = '';
    showStatus('otpStatus', '', 'info');
}

// ==================== EXAM FUNCTIONS ====================
function startExam() {
    const level = userData.level;
    const questions = questionDatabase[level];
    
    // Set exam title
    document.getElementById('examTitle').innerHTML = 
        `<i class="fas fa-file-alt"></i> ${level.toUpperCase()} Level Examination`;
    
    // Generate questions HTML
    let questionsHTML = '';
    questions.forEach((q, index) => {
        questionsHTML += `
            <div class="question-box">
                <div class="question-number">
                    <i class="fas fa-question-circle"></i> Question ${index + 1} / ${questions.length}
                </div>
                <p><strong>${q.question}</strong></p>
                <div class="form-group">
                    <textarea id="answer_${index}" 
                              placeholder="Type your answer here (minimum 50 characters)..."
                              rows="4"></textarea>
                </div>
                <div class="keyword-hint">
                    <i class="fas fa-lightbulb"></i> Keywords to include: ${q.keywords.join(', ')}
                </div>
            </div>
        `;
    });
    
    document.getElementById('questionsContainer').innerHTML = questionsHTML;
    document.getElementById('examBox').classList.remove('hidden');
    
    // Scroll to exam section
    document.getElementById('examBox').scrollIntoView({ behavior: 'smooth' });
}

function submitExam() {
    const level = userData.level;
    const questions = questionDatabase[level];
    let score = 0;
    userData.answers = [];
    
    // Validate all answers
    let allAnswered = true;
    for (let i = 0; i < questions.length; i++) {
        const answer = document.getElementById(`answer_${i}`).value.trim();
        if (!answer || answer.length < 50) {
            allAnswered = false;
            showStatus('examStatus', `Please provide a proper answer for Question ${i + 1} (minimum 50 characters)`, 'error');
            document.getElementById(`answer_${i}`).focus();
            return;
        }
        
        // Store answer
        userData.answers.push({
            question: questions[i].question,
            answer: answer,
            keywords: questions[i].keywords
        });
        
        // Calculate score based on keywords
        const answerLower = answer.toLowerCase();
        let keywordMatches = 0;
        questions[i].keywords.forEach(keyword => {
            if (answerLower.includes(keyword.toLowerCase())) {
                keywordMatches++;
            }
        });
        
        // Award points: 2+ keywords = 1 point, 4+ keywords = 2 points
        if (keywordMatches >= 4) {
            score += 2;
        } else if (keywordMatches >= 2) {
            score += 1;
        }
    }
    
    if (!allAnswered) return;
    
    showLoading('submitExamBtn');
    
    // Calculate results
    userData.score = score;
    userData.percent = Math.round((score / 20) * 100); // Max 20 points
    userData.certificateId = `CX-${Date.now()}-${Math.floor(Math.random() * 1000)}`;
    
    // Simulate processing delay
    setTimeout(() => {
        showResults();
        hideLoading('submitExamBtn');
    }, 1500);
}

function showResults() {
    const isQualified = userData.percent >= 80;
    
    let resultsHTML = `
        <div class="result-summary">
            <h3>${userData.name}</h3>
            <p>Group: <strong>${userData.group}</strong></p>
            <p>Level: <strong>${userData.level.toUpperCase()}</strong></p>
            <hr style="margin: 20px 0; border-color: rgba(0,255,213,0.3);">
            
            <div class="score-display">${userData.percent}%</div>
            <p>Score: <strong>${userData.score}/20 points</strong></p>
            
            ${isQualified ? 
                `<div class="qualification-badge">
                    <i class="fas fa-trophy"></i> QUALIFIED
                </div>` : 
                `<div style="color: #ff4d4d; font-weight: bold; margin: 20px 0;">
                    <i class="fas fa-times-circle"></i> NOT QUALIFIED
                </div>`
            }
        </div>
        
        <h3><i class="fas fa-list-check"></i> Detailed Analysis</h3>
    `;
    
    // Add answer analysis
    userData.answers.forEach((item, index) => {
        const keywordsFound = item.keywords.filter(keyword => 
            item.answer.toLowerCase().includes(keyword.toLowerCase())
        ).length;
        
        resultsHTML += `
            <div class="question-box" style="margin-bottom: 15px;">
                <p><strong>Q${index + 1}:</strong> ${item.question}</p>
                <p><strong>Your Answer:</strong> ${item.answer.substring(0, 150)}${item.answer.length > 150 ? '...' : ''}</p>
                <p style="color: ${keywordsFound >= 2 ? '#00ff88' : '#ff4d4d'};">
                    <i class="fas fa-${keywordsFound >= 2 ? 'check' : 'times'}"></i> 
                    Keywords matched: ${keywordsFound}/${item.keywords.length}
                </p>
            </div>
        `;
    });
    
    // Add action buttons
    resultsHTML += `
        <div class="text-center" style="margin-top: 30px;">
            ${isQualified ? 
                `<button class="btn btn-primary" onclick="generateCertificate()">
                    <i class="fas fa-certificate"></i> Generate Certificate
                </button>` : 
                `<button class="btn btn-secondary" onclick="retryExam()">
                    <i class="fas fa-redo"></i> Try Again
                </button>`
            }
            <button class="btn" onclick="showWhatsAppSubmission()">
                <i class="fab fa-whatsapp"></i> Submit via WhatsApp
            </button>
        </div>
    `;
    
    document.getElementById('resultsContent').innerHTML = resultsHTML;
    document.getElementById('examBox').classList.add('hidden');
    document.getElementById('resultsBox').classList.remove('hidden');
    
    // Scroll to results
    document.getElementById('resultsBox').scrollIntoView({ behavior: 'smooth' });
}

function retryExam() {
    document.getElementById('resultsBox').classList.add('hidden');
    startExam();
}

// ==================== CERTIFICATE FUNCTIONS ====================
function generateCertificate() {
    const issueDate = new Date().toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    
    const certificateHTML = `
        <div class="certificate">
            <div class="watermark">CYBERXCODE</div>
            
            <h1 class="certificate-header">
                <i class="fas fa-shield-alt"></i> CYBERSECURITY QUALIFICATION CERTIFICATE
            </h1>
            
            <p style="font-size: 1.3rem; margin: 20px 0;">This is to certify that</p>
            
            <h3>${userData.name}</h3>
            
            <p style="font-size: 1.3rem; margin: 30px 0;">
                has successfully completed the
                <br>
                <strong>${userData.level.toUpperCase()} LEVEL CYBERSECURITY ASSESSMENT</strong>
            </p>
            
            <div class="certificate-details">
                <p><strong>Group:</strong> ${userData.group}</p>
                <p><strong>Score:</strong> ${userData.percent}% (${userData.score}/20 points)</p>
                <p><strong>Certificate ID:</strong> ${userData.certificateId}</p>
                <p><strong>Date Issued:</strong> ${issueDate}</p>
                <p><strong>Valid Until:</strong> ${new Date(new Date().setFullYear(new Date().getFullYear() + 1)).toLocaleDateString()}</p>
            </div>
            
            <div class="issuer-info">
                <p style="margin-bottom: 20px;">Issued by:</p>
                <h4 style="color: #004a3d; margin-bottom: 10px;">CyberXcode Global Alliance</h4>
                <p>CyberXcode|BLACK CODE UNION | Chip Exploit</p>
                
                <div style="margin-top: 40px; display: flex; justify-content: center; gap: 50px;">
                    <div>
                        <div style="border-top: 2px solid #000; width: 150px; margin-top: 60px;"></div>
                        <p>Authorized Signature</p>
                    </div>
                    <div>
                        <div style="border-top: 2px solid #000; width: 150px; margin-top: 60px;"></div>
                        <p>Director, CyberXcode</p>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 40px; font-size: 0.9rem; color: #666;">
                <p>Verify this certificate at: https://cyberxcode2.wordpress.com</p>
                <p>Certificate ID: ${userData.certificateId}</p>
            </div>
        </div>
        
        <div class="text-center" style="margin: 30px 0;">
            <button class="btn btn-primary" onclick="window.print()">
                <i class="fas fa-print"></i> Print Certificate
            </button>
            <button class="btn btn-secondary" onclick="showWhatsAppSubmission()">
                <i class="fab fa-whatsapp"></i> Share via WhatsApp
            </button>
            <button class="btn" onclick="document.getElementById('certificateBox').classList.add('hidden')">
                <i class="fas fa-times"></i> Close
            </button>
        </div>
    `;
    
    document.getElementById('certificateBox').innerHTML = certificateHTML;
    document.getElementById('certificateBox').classList.remove('hidden');
    document.getElementById('resultsBox').classList.add('hidden');
    
    // Scroll to certificate
    document.getElementById('certificateBox').scrollIntoView({ behavior: 'smooth' });
}

// ==================== WHATSAPP FUNCTIONS ====================
function showWhatsAppSubmission() {
    document.getElementById('whatsappInfo').classList.remove('hidden');
    document.getElementById('whatsappInfo').scrollIntoView({ behavior: 'smooth' });
}

function sendWhatsAppMessage() {
    showLoading('whatsappBtn');
    
    // Format the WhatsApp message
    let message = `*New Exam Submission - CyberXcode*\n\n`;
    message += `*Candidate:* ${userData.name}\n`;
    message += `*Email:* ${userData.email}\n`;
    if (userData.phone) message += `*Phone:* ${userData.phone}\n`;
    message += `*Group:* ${userData.group}\n`;
    message += `*Level:* ${userData.level.toUpperCase()}\n`;
    message += `*Score:* ${userData.score}/20 (${userData.percent}%)\n`;
    message += `*Certificate ID:* ${userData.certificateId}\n\n`;
    
    message += `*Questions & Answers:*\n`;
    userData.answers.forEach((item, index) => {
        message += `\n*Q${index + 1}:* ${item.question}\n`;
        message += `*A${index + 1}:* ${item.answer.substring(0, 100)}${item.answer.length > 100 ? '...' : ''}\n`;
        
        // Count keyword matches
        const matches = item.keywords.filter(k => 
            item.answer.toLowerCase().includes(k.toLowerCase())
        ).length;
        message += `Keywords matched: ${matches}/${item.keywords.length}\n`;
        message += `────────────────────\n`;
    });
    
    message += `\n*Submission Details:*\n`;
    message += `Website: cyberxcode2.wordpress.com\n`;
    message += `Instagram: @alpha.x.admin\n`;
    message += `Timestamp: ${new Date().toLocaleString()}\n`;
    
    // Encode the message for URL
    const encodedMessage = encodeURIComponent(message);
    
    // WhatsApp phone number (CyberXcode Admin)
    const whatsappNumber = "919332445064"; // Admin number
    
    // Create WhatsApp URL
    const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
    
    // Open WhatsApp in new tab
    setTimeout(() => {
        window.open(whatsappURL, '_blank');
        hideLoading('whatsappBtn');
        
        // Show success message
        showStatus('whatsappInfo', 'WhatsApp opened successfully! Please send the message.', 'success');
        
        // Close after 5 seconds
        setTimeout(() => {
            document.getElementById('whatsappInfo').classList.add('hidden');
        }, 5000);
    }, 1000);
}

// ==================== INITIALIZATION ====================
// Input validation for OTP
document.getElementById('otpInput')?.addEventListener('input', function(e) {
    this.value = this.value.replace(/[^0-9]/g, '');
    if (this.value.length > 6) {
        this.value = this.value.slice(0, 6);
    }
});

// Enter key support for OTP
document.getElementById('otpInput')?.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        verifyOTP();
    }
});

// Initialize EmailJS with your credentials
emailjs.init("ZChIVqjZCd1qV9gTb"); // Replace with your actual EmailJS Public Key

console.log("CyberXcode Portal Loaded Successfully");
console.log("Official Website: https://cyberxcode2.wordpress.com");
console.log("Instagram: @alpha.x.admin");
</script>
</body>
</html>